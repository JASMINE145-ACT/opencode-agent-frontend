<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0"
    />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Dashboard | DataOrchestrator - Data Platform & AI Agent</title>
    <script src="./components/api-client.js" type="module"></script>
  </head>
   <body
    x-data="{
      page: 'dashboard',
      'loaded': true,
      'darkMode': false,
      'stickyMenu': false,
      'sidebarToggle': false,
      'scrollTop': false,
      sessions: [],
      files: []
    }"
    x-init="
         darkMode = JSON.parse(localStorage.getItem('darkMode'));
         $watch('darkMode', value => localStorage.setItem('darkMode', JSON.stringify(value)));

         // Load sessions
         const savedSessions = localStorage.getItem('chatSessions');
         if (savedSessions) {
           sessions = JSON.parse(savedSessions);
         }

         // Load files
         const savedFiles = localStorage.getItem('chatFiles');
         if (savedFiles) {
           files = JSON.parse(savedFiles);
         }

         // Check authentication
         if (!localStorage.getItem('token')) {
           window.location.href = 'login.html';
         }

         // Logout function (only called when user clicks Logout)
         window.logout = async function() {
           localStorage.removeItem('token');
           localStorage.removeItem('user');
           window.location.href = 'login.html';
         };"
     :class="{'dark bg-gray-900': darkMode === true}"
  >
    <!-- ===== Preloader Start ===== -->
    <include src="./partials/preloader.html"></include>
    <!-- ===== Preloader End ===== -->

    <!-- ===== Page Wrapper Start ===== -->
    <div class="flex h-screen overflow-hidden">
      <!-- ===== Sidebar Start ===== -->
      <include src="./partials/sidebar-custom.html"></include>
      <!-- ===== Sidebar End ===== -->

      <!-- ===== Content Area Start ===== -->
      <div
        class="relative flex flex-col flex-1 overflow-x-hidden overflow-y-auto"
      >
        <!-- Small Device Overlay Start -->
        <include src="./partials/overlay.html" />
        <!-- Small Device Overlay End -->

        <!-- ===== Header Start ===== -->
        <include src="./partials/header-custom.html" />
        <!-- ===== Header End ===== -->

        <!-- ===== Main Content Start ===== -->
        <main>
          <div class="p-4 mx-auto max-w-(--breakpoint-2xl) md:p-6">
            <!-- Page Title -->
            <div class="mb-6">
              <h1 class="mb-1 font-semibold text-gray-800 text-title-md dark:text-white/90">
                Welcome to DataOrchestrator
              </h1>
              <p class="text-sm text-gray-500 dark:text-gray-400">
                Unified platform for data queries and AI-powered analysis
              </p>
            </div>

             <!-- Quick Entry Cards -->
             <div class="grid grid-cols-1 gap-4 md:gap-6 lg:grid-cols-2 xl:grid-cols-3">
               <!-- Main Chat Card (NEW) -->
               <a href="main-chat.html" class="group">
                 <div class="h-full p-6 transition-all bg-gradient-to-br from-brand-50 to-purple-50 border border-brand-200 rounded-xl shadow-sm hover:shadow-lg dark:from-brand-900/20 dark:to-purple-900/20 dark:border-brand-700 hover:border-brand-500">
                   <div class="flex items-start justify-between mb-4">
                     <div class="p-3 rounded-lg bg-brand-100 dark:bg-brand-900/40">
                       <svg
                         class="text-brand-600 dark:text-brand-400"
                         width="24"
                         height="24"
                         viewBox="0 0 24 24"
                         fill="none"
                         xmlns="http://www.w3.org/2000/svg"
                       >
                         <path
                           d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"
                           stroke="currentColor"
                           stroke-width="2"
                           stroke-linecap="round"
                           stroke-linejoin="round"
                         />
                       </svg>
                     </div>
                     <div class="px-2 py-1 bg-brand-100 rounded-full text-xs font-semibold text-brand-600 dark:bg-brand-900/40 dark:text-brand-400">
                       NEW
                     </div>
                   </div>
                   <h3 class="mb-2 font-semibold text-gray-900 text-lg dark:text-white">
                     Main Chat
                   </h3>
                   <p class="text-sm text-gray-600 dark:text-gray-400">
                     Unified AI conversation interface. Chat with your data, analyze files, and get intelligent insights.
                   </p>
                   <div class="mt-4 pt-4 border-t border-brand-100 dark:border-brand-700/50">
                     <span class="text-sm font-medium text-brand-600 dark:text-brand-400">
                       Start Chatting â†’
                     </span>
                   </div>
                 </div>
               </a>

               <!-- Data Search Card -->
               <a href="data_search.html" class="group">
                 <div class="h-full p-6 transition-all bg-white border border-gray-200 rounded-xl shadow-sm hover:shadow-lg dark:bg-gray-800 dark:border-gray-700 hover:border-brand-500">
                   <div class="flex items-start justify-between mb-4">
                     <div class="p-3 rounded-lg bg-brand-50 dark:bg-brand-900/20">
                       <svg
                         class="text-brand-500"
                         width="24"
                         height="24"
                         viewBox="0 0 24 24"
                         fill="none"
                         xmlns="http://www.w3.org/2000/svg"
                       >
                         <path
                           d="M21 21L15 15M17 10C17 13.866 13.866 17 10 17C6.13401 17 3 13.866 3 10C3 6.13401 6.13401 3 10 3C13.866 3 17 6.13401 17 10Z"
                           stroke="currentColor"
                           stroke-width="2"
                           stroke-linecap="round"
                           stroke-linejoin="round"
                         />
                       </svg>
                     </div>
                     <svg
                       class="text-gray-400 transition-transform group-hover:translate-x-1 dark:text-gray-500"
                       width="20"
                       height="20"
                       viewBox="0 0 20 20"
                       fill="none"
                       xmlns="http://www.w3.org/2000/svg"
                     >
                       <path
                         d="M4.16683 10L8.50016 14.3333L15.8335 5"
                         stroke="currentColor"
                         stroke-width="2"
                         stroke-linecap="round"
                         stroke-linejoin="round"
                       />
                     </svg>
                   </div>
                   <h3 class="mb-2 font-semibold text-gray-900 text-lg dark:text-white">
                     Data Search
                   </h3>
                   <p class="text-sm text-gray-600 dark:text-gray-400">
                     Query your data using natural language. Get instant results with SQL insights and visualizations.
                   </p>
                   <div class="mt-4 pt-4 border-t border-gray-100 dark:border-gray-700">
                     <span class="text-sm font-medium text-brand-500 dark:text-brand-400">
                       Get Started â†’
                     </span>
                   </div>
                 </div>
               </a>

               <!-- Excel/Chat Card -->
               <a href="excel_chat.html" class="group">
                 <div class="h-full p-6 transition-all bg-white border border-gray-200 rounded-xl shadow-sm hover:shadow-lg dark:bg-gray-800 dark:border-gray-700 hover:border-brand-500">
                   <div class="flex items-start justify-between mb-4">
                     <div class="p-3 rounded-lg bg-purple-50 dark:bg-purple-900/20">
                       <svg
                         class="text-purple-500"
                         width="24"
                         height="24"
                         viewBox="0 0 24 24"
                         fill="none"
                         xmlns="http://www.w3.org/2000/svg"
                       >
                         <path
                           d="M8 2H16C17.1 2 18 2.9 18 4V20C18 21.1 17.1 22 16 22H8C6.9 22 6 21.1 6 20V4C6 2.9 6.9 2 8 2ZM16 4H8V20H16V4ZM10 6H14V8H10V6ZM10 10H14V12H10V10ZM10 14H14V16H10V14Z"
                           fill="currentColor"
                         />
                       </svg>
                     </div>
                     <svg
                       class="text-gray-400 transition-transform group-hover:translate-x-1 dark:text-gray-500"
                       width="20"
                       height="20"
                       viewBox="0 0 20 20"
                       fill="none"
                       xmlns="http://www.w3.org/2000/svg"
                     >
                       <path
                         d="M4.16683 10L8.50016 14.3333L15.8335 5"
                         stroke="currentColor"
                         stroke-width="2"
                         stroke-linecap="round"
                         stroke-linejoin="round"
                       />
                     </svg>
                   </div>
                   <h3 class="mb-2 font-semibold text-gray-900 text-lg dark:text-white">
                     Excel Analysis
                   </h3>
                   <p class="text-sm text-gray-600 dark:text-gray-400">
                     Upload Excel files for AI-powered analysis and insights.
                   </p>
                   <div class="mt-4 pt-4 border-t border-gray-100 dark:border-gray-700">
                     <span class="text-sm font-medium text-purple-500 dark:text-purple-400">
                       Analyze Files â†’
                     </span>
                   </div>
                 </div>
               </a>
             </div>

             <!-- Quick Stats -->
             <div class="mt-8">
               <h2 class="mb-4 font-semibold text-gray-800 text-lg dark:text-white">
                 Quick Stats
               </h2>
               <div class="grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-4">
                 <div class="p-4 bg-white border border-gray-200 rounded-xl dark:bg-gray-800 dark:border-gray-700">
                   <div class="text-sm text-gray-500 dark:text-gray-400">Total Sessions</div>
                   <div class="mt-2 text-2xl font-semibold text-gray-900 dark:text-white" x-text="sessions.length"></div>
                 </div>
                 <div class="p-4 bg-brand-50 border border-brand-200 rounded-xl dark:bg-brand-900/20 dark:border-brand-800">
                   <div class="text-sm text-brand-600 dark:text-brand-400">Active Conversations</div>
                   <div class="mt-2 text-2xl font-semibold text-brand-600 dark:text-brand-400" x-text="sessions.filter(s => s.messages && s.messages.length > 0).length"></div>
                 </div>
                 <div class="p-4 bg-purple-50 border border-purple-200 rounded-xl dark:bg-purple-900/20 dark:border-purple-800">
                   <div class="text-sm text-purple-600 dark:text-purple-400">Uploaded Files</div>
                   <div class="mt-2 text-2xl font-semibold text-purple-600 dark:text-purple-400" x-text="files.length"></div>
                 </div>
                 <div class="p-4 bg-green-50 border border-green-200 rounded-xl dark:bg-green-900/20 dark:border-green-800">
                   <div class="text-sm text-green-600 dark:text-green-400">Total Messages</div>
                   <div class="mt-2 text-2xl font-semibold text-green-600 dark:text-green-400" x-text="sessions.reduce((acc, s) => acc + (s.messages ? s.messages.length : 0), 0)"></div>
                 </div>
               </div>
             </div>

             <!-- Recent Sessions -->
             <div x-show="sessions.length > 0" class="mt-8">
               <h2 class="mb-4 font-semibold text-gray-800 text-lg dark:text-white">
                 Recent Sessions
               </h2>
               <div class="bg-white border border-gray-200 rounded-xl overflow-hidden dark:bg-gray-800 dark:border-gray-700">
                 <div class="overflow-x-auto">
                   <table class="w-full text-left">
                     <thead class="bg-gray-50 dark:bg-gray-700/50">
                       <tr>
                         <th class="px-4 py-3 text-xs font-semibold text-gray-500 uppercase tracking-wider dark:text-gray-400">Title</th>
                         <th class="px-4 py-3 text-xs font-semibold text-gray-500 uppercase tracking-wider dark:text-gray-400">Messages</th>
                         <th class="px-4 py-3 text-xs font-semibold text-gray-500 uppercase tracking-wider dark:text-gray-400">Date</th>
                         <th class="px-4 py-3 text-xs font-semibold text-gray-500 uppercase tracking-wider dark:text-gray-400">Action</th>
                       </tr>
                     </thead>
                     <tbody>
                       <template x-for="session in sessions.slice(0, 5)" :key="session.id">
                         <tr class="border-t border-gray-100 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-700/50">
                           <td class="px-4 py-3 text-sm text-gray-800 dark:text-gray-200" x-text="session.title"></td>
                           <td class="px-4 py-3 text-sm text-gray-600 dark:text-gray-400" x-text="session.messages ? session.messages.length : 0"></td>
                           <td class="px-4 py-3 text-sm text-gray-600 dark:text-gray-400" x-text="new Date(session.createdAt).toLocaleDateString()"></td>
                           <td class="px-4 py-3">
                             <a :href="'main-chat.html?session=' + session.id" class="text-sm font-medium text-brand-500 hover:text-brand-600 dark:text-brand-400">
                               Open â†’
                             </a>
                           </td>
                         </tr>
                       </template>
                     </tbody>
                   </table>
                 </div>
               </div>
             </div>

             <!-- Empty State (No Sessions) -->
             <div x-show="sessions.length === 0" class="mt-8 text-center py-12 bg-white border border-gray-200 rounded-xl dark:bg-gray-800 dark:border-gray-700">
               <div class="text-6xl mb-4">ðŸ’¬</div>
               <h3 class="mb-2 text-lg font-semibold text-gray-900 dark:text-white">No conversations yet</h3>
               <p class="text-sm text-gray-500 dark:text-gray-400 mb-4">Start a new conversation to get started</p>
               <a href="main-chat.html" class="inline-flex items-center px-4 py-2 text-sm font-medium text-white transition rounded-lg bg-brand-500 shadow-theme-xs hover:bg-brand-600">
                 Start Chatting
               </a>
             </div>
          </div>
        </main>
        <!-- ===== Main Content End ===== -->
      </div>
      <!-- ===== Content Area End ===== -->
    </div>
    <!-- ===== Page Wrapper End ===== -->
  </body>
</html>
